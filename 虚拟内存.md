# 虚拟内存

虚拟寻址：虚拟地址 -由CPU中的MMU进行地址翻译-> 物理地址

虚拟页的三个状态：未分配、已缓存、未缓存

页表：
* 页表放在主存中，CPU的页表基址寄存器存储页表地址，均由OS负责维护
* 每个进程一个页表
* 记录虚拟页到物理页的映射（有效位、物理页号或磁盘地址）
* 记录每个虚拟页的读写权限、是否允许用户态访问等
* 缺页时触发中断，由OS进行换页处理，并更新页表

TLB：
* MMU内置的页表缓存
* 虚拟页号前N位作标记，后M位作索引，则TLB可缓存`2^M`组记录

Linux进程的虚拟内存空间：
* 内核区
    * 进程相关的数据（页表、内核栈） 
    * 到特定物理内存区域的映射（所有进程都一样）
    * 内核代码与数据（所有进程都一样）
* 用户区
    * 栈（向下增长）
    * ...
    * 共享库映射区（向上增长）
    * ...
    * 堆（向上增长）
    * .bss - 未初始化的全局数据，初始时映射到全0页，修改后copy-on-write
    * .data - 已初始化的全局数据
    * .text - 代码与常量
    * ...
